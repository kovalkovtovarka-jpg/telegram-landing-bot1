# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Webhook –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–Ω

## üìã –û–±–∑–æ—Ä

Webhook —Ä–µ–∂–∏–º —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–Ω, —Ç–∞–∫ –∫–∞–∫ –æ–Ω:
- ‚úÖ –ë–æ–ª–µ–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–µ–Ω (–Ω–µ –Ω—É–∂–Ω–æ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ –æ–ø—Ä–∞—à–∏–≤–∞—Ç—å Telegram API)
- ‚úÖ –ú–µ–Ω—å—à–µ –Ω–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä
- ‚úÖ –ë—ã—Å—Ç—Ä–µ–µ –æ—Ç–∫–ª–∏–∫ –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏—è
- ‚úÖ –ú–µ–Ω—å—à–µ —Ä–∞—Å—Ö–æ–¥ API –∑–∞–ø—Ä–æ—Å–æ–≤

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞

### 1. –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Å–ª–µ–¥—É—é—â–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –≤ –≤–∞—à–µ–º `.env` —Ñ–∞–π–ª–µ –∏–ª–∏ –Ω–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ –¥–µ–ø–ª–æ—è:

```bash
# –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–ª—è webhook
WEBHOOK_URL=https://your-app-name.railway.app
# –∏–ª–∏ –¥–ª—è Render:
# WEBHOOK_URL=https://your-app-name.onrender.com

# –ü–æ—Ä—Ç (–æ–±—ã—á–Ω–æ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞ Railway/Render —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é PORT)
# –ï—Å–ª–∏ –Ω—É–∂–Ω–æ —É–∫–∞–∑–∞—Ç—å –≤—Ä—É—á–Ω—É—é:
# WEBHOOK_PORT=8443

# PostgreSQL (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–Ω)
DATABASE_URL=postgresql://user:password@host:5432/database

# –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã
BOT_ADMIN_IDS=979250893
```

### 2. Procfile

–î–ª—è webhook —Ä–µ–∂–∏–º–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ:

```
web: python webhook.py
```

–î–ª—è polling —Ä–µ–∂–∏–º–∞ (–∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞):

```
worker: python main.py
```

### 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –Ω–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞—Ö

#### Railway

1. –°–æ–∑–¥–∞–π—Ç–µ –ø—Ä–æ–µ–∫—Ç –Ω–∞ [Railway](https://railway.app)
2. –ü–æ–¥–∫–ª—é—á–∏—Ç–µ GitHub —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
3. Railway –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç `Procfile` –∏ –∑–∞–¥–µ–ø–ª–æ–∏—Ç
4. **–ü–æ—Å–ª–µ –¥–µ–ø–ª–æ—è –Ω–∞–π–¥–∏—Ç–µ URL –≤–∞—à–µ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:**
   - –û—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–æ–µ–∫—Ç –≤ Railway
   - –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ –≤–∫–ª–∞–¥–∫—É **"Settings"** ‚Üí **"Networking"**
   - –ò–ª–∏ –Ω–∞ –≤–∫–ª–∞–¥–∫—É **"Deployments"** ‚Üí –Ω–∞–π–¥–∏—Ç–µ URL –≤ –ª–æ–≥–∞—Ö
   - –°–∫–æ–ø–∏—Ä—É–π—Ç–µ URL (–Ω–∞–ø—Ä–∏–º–µ—Ä: `https://your-app-name.railway.app`)
5. –î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –≤ Railway:
   - `TELEGRAM_BOT_TOKEN`
   - `OPENAI_API_KEY` (–∏–ª–∏ –¥—Ä—É–≥–æ–π –ø—Ä–æ–≤–∞–π–¥–µ—Ä)
   - `WEBHOOK_URL` - –≤—Å—Ç–∞–≤—å—Ç–µ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–Ω—ã–π URL (–Ω–∞–ø—Ä–∏–º–µ—Ä: `https://your-app-name.railway.app`)
   - `DATABASE_URL` - URL PostgreSQL –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
   - `BOT_ADMIN_IDS=979250893`
6. Railway –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é `PORT`
7. Railway –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö

**–í–∞–∂–Ω–æ:** URL –ø–æ—è–≤–ª—è–µ—Ç—Å—è **–ü–û–°–õ–ï** –¥–µ–ø–ª–æ—è! –°–Ω–∞—á–∞–ª–∞ –∑–∞–¥–µ–ø–ª–æ–π—Ç–µ, –ø–æ—Ç–æ–º –ø–æ–ª—É—á–∏—Ç–µ URL –∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ `WEBHOOK_URL`.

#### Render

1. –°–æ–∑–¥–∞–π—Ç–µ Web Service –Ω–∞ [Render](https://render.com)
2. –ü–æ–¥–∫–ª—é—á–∏—Ç–µ GitHub —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
3. –ù–∞—Å—Ç—Ä–æ–π–∫–∏:
   - **Build Command:** `pip install -r requirements.txt`
   - **Start Command:** `python webhook.py`
   - **Python Version:** 3.12
4. Render –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–¥–µ–ø–ª–æ–∏—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
5. **–ü–æ—Å–ª–µ –¥–µ–ø–ª–æ—è –Ω–∞–π–¥–∏—Ç–µ URL –≤–∞—à–µ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:**
   - URL –±—É–¥–µ—Ç –ø–æ–∫–∞–∑–∞–Ω –≤–≤–µ—Ä—Ö—É —Å—Ç—Ä–∞–Ω–∏—Ü—ã —Å–µ—Ä–≤–∏—Å–∞
   - –§–æ—Ä–º–∞—Ç: `https://your-app-name.onrender.com`
   - –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —ç—Ç–æ—Ç URL
6. –î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –≤ Render:
   - `TELEGRAM_BOT_TOKEN`
   - `OPENAI_API_KEY` (–∏–ª–∏ –¥—Ä—É–≥–æ–π –ø—Ä–æ–≤–∞–π–¥–µ—Ä)
   - `WEBHOOK_URL` - –≤—Å—Ç–∞–≤—å—Ç–µ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–Ω—ã–π URL (–Ω–∞–ø—Ä–∏–º–µ—Ä: `https://your-app-name.onrender.com`)
   - `DATABASE_URL` - URL PostgreSQL –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
   - `BOT_ADMIN_IDS=979250893`
7. Render –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é `PORT`
8. Render –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç —Å–µ—Ä–≤–∏—Å –ø–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö

**–í–∞–∂–Ω–æ:** URL –ø–æ—è–≤–ª—è–µ—Ç—Å—è **–ü–û–°–õ–ï** –¥–µ–ø–ª–æ—è! –°–Ω–∞—á–∞–ª–∞ –∑–∞–¥–µ–ø–ª–æ–π—Ç–µ, –ø–æ—Ç–æ–º –ø–æ–ª—É—á–∏—Ç–µ URL –∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ `WEBHOOK_URL`.

### 4. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

–ü–æ—Å–ª–µ –¥–µ–ø–ª–æ—è –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:

1. **Health check endpoint:**
   ```
   https://your-app-name.railway.app/health
   ```
   –î–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å JSON —Å —Å—Ç–∞—Ç—É—Å–æ–º `"status": "healthy"`

2. **–õ–æ–≥–∏:**
   - Railway: –≤–∫–ª–∞–¥–∫–∞ "Logs"
   - Render: –≤–∫–ª–∞–¥–∫–∞ "Logs"
   - –î–æ–ª–∂–Ω—ã –±—ã—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è:
     ```
     ‚úì Webhook —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω: https://your-app-name.railway.app/webhook
     ‚úì Webhook —Å–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω –Ω–∞ –ø–æ—Ä—Ç—É XXXX
     ```

3. **–¢–µ—Å—Ç –±–æ—Ç–∞:**
   - –û—Ç–ø—Ä–∞–≤—å—Ç–µ `/start` –±–æ—Ç—É –≤ Telegram
   - –ë–æ—Ç –¥–æ–ª–∂–µ–Ω –æ—Ç–≤–µ—Ç–∏—Ç—å

## üîç –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### Webhook –Ω–µ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è

**–ü—Ä–æ–±–ª–µ–º–∞:** –í –ª–æ–≥–∞—Ö –æ—à–∏–±–∫–∞ "WEBHOOK_URL –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω"

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è `WEBHOOK_URL` —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ URL –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å `https://`
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ URL –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π (–±–µ–∑ `/webhook` –≤ –∫–æ–Ω—Ü–µ)

### Health check –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

**–ü—Ä–æ–±–ª–µ–º–∞:** `https://your-app.com/health` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ—à–∏–±–∫—É

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –æ—à–∏–±–æ–∫
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –¥–æ—Å—Ç—É–ø–Ω–∞
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ LLM API –∫–ª—é—á —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω

### –ë–æ—Ç –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç

**–ü—Ä–æ–±–ª–µ–º–∞:** –ë–æ—Ç –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏—è

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –æ—à–∏–±–æ–∫
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ webhook —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω: `https://your-app.com/webhook`
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ `TELEGRAM_BOT_TOKEN` –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π
4. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

### –ü–æ—Ä—Ç –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

**–ü—Ä–æ–±–ª–µ–º–∞:** –û—à–∏–±–∫–∞ "Address already in use" –∏–ª–∏ –ø–æ—Ä—Ç –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω

**–†–µ—à–µ–Ω–∏–µ:**
1. –ù–∞ Railway/Render –ø–æ—Ä—Ç —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é `PORT`
2. –ù–µ —É–∫–∞–∑—ã–≤–∞–π—Ç–µ `WEBHOOK_PORT` –≤—Ä—É—á–Ω—É—é, –µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ Railway/Render
3. –ï—Å–ª–∏ –Ω—É–∂–Ω–æ —É–∫–∞–∑–∞—Ç—å –≤—Ä—É—á–Ω—É—é, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `WEBHOOK_PORT`

## üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

1. **HTTPS –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω:** Telegram —Ç—Ä–µ–±—É–µ—Ç HTTPS –¥–ª—è webhook
2. **–ü–æ—Ä—Ç:** –ù–∞ Railway/Render –ø–æ—Ä—Ç —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
3. **URL:** –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ `WEBHOOK_URL` —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –¥–æ–º–µ–Ω
4. **PostgreSQL:** –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ PostgreSQL –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–Ω (–Ω–µ SQLite)

## üîÑ –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –º–µ–∂–¥—É —Ä–µ–∂–∏–º–∞–º–∏

### –° webhook –Ω–∞ polling:

1. –ò–∑–º–µ–Ω–∏—Ç–µ `Procfile`:
   ```
   worker: python main.py
   ```

2. –£–¥–∞–ª–∏—Ç–µ –∏–ª–∏ –∑–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ `WEBHOOK_URL`

3. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

### –° polling –Ω–∞ webhook:

1. –ò–∑–º–µ–Ω–∏—Ç–µ `Procfile`:
   ```
   web: python webhook.py
   ```

2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ `WEBHOOK_URL`

3. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

## ‚úÖ –ß–µ–∫–ª–∏—Å—Ç

–ü–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º —É–±–µ–¥–∏—Ç–µ—Å—å:

- [ ] `WEBHOOK_URL` —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∏ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π
- [ ] `DATABASE_URL` —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ PostgreSQL
- [ ] `BOT_ADMIN_IDS` —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω (979250893)
- [ ] `Procfile` —Å–æ–¥–µ—Ä–∂–∏—Ç `web: python webhook.py`
- [ ] –í—Å–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã
- [ ] Health check —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è
- [ ] –ë–æ—Ç –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ –∫–æ–º–∞–Ω–¥—ã

## üéâ –ì–æ—Ç–æ–≤–æ!

–ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ webhook –≤–∞—à –±–æ—Ç –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –±–æ–ª–µ–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –≤ –ø—Ä–æ–¥–∞–∫—à–Ω —Ä–µ–∂–∏–º–µ!
